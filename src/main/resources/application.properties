# Server Configuration
server.port=8080

# ClickHouse Connection (HTTP endpoint)
clickhouse.url=http://172.30.117.206:8123
clickhouse.username=default
clickhouse.database=kavach
clickhouse.table=nms_event_adjacent_kavach_train_rri
clickhouse.password=Vamshi@954

# clickhouse.url=http://nms.clickhouse.bluepalapps.com:8123
# clickhouse.username=nmsdevuser
# clickhouse.database=nmsDb
# clickhouse.table=nms_event_adjacent_kavach_train_rri1
# clickhouse.password=BluepalCHouse123!

# Kafka
kafka.bootstrap-servers=172.30.117.206:9092
kafka.topic=clickhouse-input
kafka.consumer.group-id=clickhouse-batch-consumer

# Logging Configuration
logging.level.org.springframework.web.reactive.function.client=OFF



# Individual Insert Configuration (reduced concurrency)
# concurrent.insert.count=6000
# concurrent.insert.max-concurrency=300
# concurrent.insert.timeout-seconds=8
# concurrent.insert.batch-size=1
concurrent.insert.count=0
concurrent.insert.max-concurrency=2
concurrent.insert.timeout-seconds=30
concurrent.insert.batch-size=25000

# WebClient Configuration (balanced for streaming + inserts)
spring.webflux.multipart.max-in-memory-size=32MB
spring.webflux.multipart.max-disk-usage-per-part=128MB
spring.webflux.client.max-connections=8
spring.webflux.client.max-idle-time=60s
spring.webflux.client.max-life-time=300s
spring.webflux.client.response-timeout=7200s

# Reactor Netty client pool (balanced)
reactor.netty.pool.maxConnections=16
reactor.netty.pool.maxIdleTime=60s
reactor.netty.pool.maxLifeTime=600s

# Server thread pool (balanced)
server.tomcat.max-threads=200
server.netty.max-threads=200
server.netty.connection-timeout=5s

# JVM tuning (optimized for ClickHouse 16GB server)
spring.task.execution.pool.max-size=400
spring.task.execution.pool.core-size=200
spring.task.execution.pool.queue-capacity=800

# ClickHouse HTTP client (client-side) â€” leave execution tuning on the server
clickhouse.http.max-connections=8
clickhouse.http.pending-acquire-max-count=256
clickhouse.http.connect-timeout-ms=3000
clickhouse.http.response-timeout-seconds=7200
clickhouse.http.keep-alive=true
clickhouse.http.tcp-no-delay=true
clickhouse.http.compression=false

# Leave server-side execution settings in ClickHouse config; do not override per request
# (max_block_size, preferred_block_size_bytes, max_threads, memory caps, etc.)

# JVM Performance Optimizations
spring.main.lazy-initialization=true
spring.jpa.open-in-view=false

# Reactor optimizations
reactor.netty.ioWorkerCount=4

# Jackson optimizations
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false

# Avoid buffering large bodies in memory during streaming
spring.codec.max-in-memory-size=1MB


